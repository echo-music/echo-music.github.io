---
layout: post
title: ä¸€æ¬¾å¥½ç”¨çš„goè¯·æ±‚å‚æ•°éªŒè¯åº“
categories: go
description: ä¸€æ¬¾å¥½ç”¨çš„goè¯·æ±‚å‚æ•°éªŒè¯åº“
keywords: go
---

æ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥çš„å€¼ï¼Œè¿™äº›è¾“å…¥çš„å‚æ•°å€¼å¦‚æœä¸éªŒè¯å®ƒï¼Œå¦åˆ™ä¼šå¸¦æ¥å¯æ€•çš„åæœï¼šå¯èƒ½P0äº‹æ•…ï¼Œå¯èƒ½ææ¡¶è·‘è·¯ï¼Œå¯èƒ½ä¸¢å¤±é¥­ç¢—ï¼Œå¯èƒ½å—æ–¹çš„é˜³å…‰ç…§ç€åŒ—æ–¹çš„é£ï¼Œï½ï½ï½è·‘é¢˜äº†ã€‚



[![pkpVBTJ.jpg](https://s21.ax1x.com/2024/04/21/pkpVBTJ.jpg)](https://imgse.com/i/pkpVBTJ)
## ä¸€ã€ èƒŒæ™¯
æ­£å¸¸æ¥è¯´æˆ‘ä»¬å†™æ¥å£çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä¼ é€’è¿‡æ¥çš„è¡¨å•æ•°æ®ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»è¦æ ¡éªŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç é‡Œä¼šæœ‰å¾ˆå¤šçš„if elseã€‚å¯èƒ½çœŸæ­£å¤„ç†ä¸šåŠ¡çš„ä»£ç æ²¡å‡ è¡Œï¼Œif else å´å æ®äº†ä¸€å¤§åŠï¼çœŸæ˜¯è¥¿çº¢æŸ¿ç‚’é¸¡è›‹-ã€‹æ“è›‹ğŸ¥šã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€æ¬¾å¥½ç”¨çš„éªŒè¯è¯·æ±‚å‚æ•°çš„åº“ï¼Œé…ç½®ä¸€ä¸‹å°±èƒ½éªŒè¯å®¢æˆ·ç«¯å®‰ä¼ é€’è¿‡æ¥çš„å‚æ•°å‘¢ï¼Ÿæœ‰çš„æˆ‘æ¨èä¸€ä¸ªç”¨ GO å¼€å‘çš„éªŒè¯è¯·æ±‚å‚æ•°çš„åº“ï¼šæ˜¯å®ƒæ˜¯å®ƒå°±æ˜¯å®ƒï¼Œå®ƒçš„åå­—å«validator
## äºŒã€å®‰è£…
```
go get -u github.com/go-playground/validator/v10

```

## ä¸‰ã€ä½¿ç”¨
```
package main

import (
	"fmt"
	"github.com/go-playground/validator/v10"
)

type User struct {
	UserName string `json:"user_name" validate:"required"`
	Password string `json:"password" validate:"required,min=6,max=20"`
}
func main() {
	example := User{
		Password: "666666",
	}
 
	//å®ä¾‹åŒ–éªŒè¯å™¨
	validate  := validator.New() 

	errs := validate.Struct(example)
	if errs != nil {
		for _, err := range errs.(validator.ValidationErrors) {
			fmt.Println("é”™è¯¯ï¼š",err)
		}
	}

}

```
è¿è¡Œä¸Šé¢ä»£ç ï¼Œç„¶åè¾“å‡º<br>

é”™è¯¯ Key: 'User.UserName' Error:Field validation for 'UserName' failed on the 'required' tag

<br>
ä½ ä¼šå‘ç°æç¤ºæ˜¯è‹±æ–‡çš„ï¼Œé‚£å¯¹æˆ‘è¿™ç§è‹±è¯­è¿‡å…«çº§çš„äººæ¥è¯´ä¸æ˜¯å¾ˆå‹å¥½ï¼Œfuck!
ä¸è¿‡ä¸è¦ç´§ï¼Œå¦‚æœéœ€è¦ç¿»è¯‘æˆä¸­æ–‡åˆ™è¿˜éœ€å®‰è£…éªŒè¯æç¤ºç¿»è¯‘åŒ…:

```
go get -u github.com/go-playground/locales
go get -u github.com/go-playground/universal-translator

```
å¼€å§‹ä½¿ç”¨å®ƒï¼š
```
package main

import (
	"fmt"
	"github.com/go-playground/locales/zh"
	ut "github.com/go-playground/universal-translator"
	"github.com/go-playground/validator/v10"
	zh_translations "github.com/go-playground/validator/v10/translations/zh"
)

type User struct {
	UserName string `json:"user_name" validate:"required"`
	Password string `json:"password" validate:"required,min=6,max=20"`
}
func main() {
	example := User{
		Password: "123",
	}
	// ä¸­æ–‡ç¿»è¯‘å™¨
	uni := ut.New(zh.New())
	trans, _ := uni.GetTranslator("zh")

	//å®ä¾‹åŒ–éªŒè¯å™¨
	validate  := validator.New()
	// æ³¨å†Œç¿»è¯‘å™¨åˆ°æ ¡éªŒå™¨
	err := zh_translations.RegisterDefaultTranslations(validate, trans)
	if err!=nil {
		fmt.Println(err)
		return
	}

	errs := validate.Struct(example)
	if errs != nil {
		for _, err := range errs.(validator.ValidationErrors) {
			fmt.Println(err.Translate(trans))
		}
	}

}

```
è¿è¡Œä»£ç è¾“å‡ºï¼š<br>
UserNameä¸ºå¿…å¡«å­—æ®µ
Passwordé•¿åº¦å¿…é¡»è‡³å°‘ä¸º6ä¸ªå­—ç¬¦

æ€ä¹ˆæ ·ï¼Œè¿˜æ˜¯å¯ä»¥çš„å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ
å‚æ•°å¤„ç†éªŒè¯å®Œä¹‹åï¼Œåé¢å°±å¯ä»¥å®‰å¿ƒçš„å¤„ç†ä¸šåŠ¡é€»è¾‘äº†




## å››ã€å‚è€ƒæ–‡æ¡£

[validator](https://pkg.go.dev/gopkg.in/go-playground/validator.v10)